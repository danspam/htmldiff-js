module.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=3)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){t.exports=n(4)},function(t,e,n){t.exports=n(5)},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function a(t,e,n,r){var i=e&&e.prototype instanceof h?e:h,o=Object.create(i.prototype),s=new b(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return W()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=m(s,n);if(a){if(a===u)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var h=c(t,e,n);if("normal"===h.type){if(r=n.done?"completed":"suspendedYield",h.arg===u)continue;return{value:h.arg,done:n.done}}"throw"===h.type&&(r="completed",n.method="throw",n.arg=h.arg)}}}(t,n,s),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=a;var u={};function h(){}function l(){}function d(){}var f={};f[i]=function(){return this};var p=Object.getPrototypeOf,v=p&&p(p(k([])));v&&v!==e&&n.call(v,i)&&(f=v);var w=d.prototype=h.prototype=Object.create(f);function g(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function y(t){var e;this._invoke=function(r,i){function o(){return new Promise((function(e,o){!function e(r,i,o,s){var a=c(t[r],t,i);if("throw"!==a.type){var u=a.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?Promise.resolve(h.__await).then((function(t){e("next",t,o,s)}),(function(t){e("throw",t,o,s)})):Promise.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return e("throw",t,o,s)}))}s(a.arg)}(r,i,e,o)}))}return e=e?e.then(o,o):o()}}function m(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,m(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function k(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:W}}function W(){return{value:void 0,done:!0}}return l.prototype=w.constructor=d,d.constructor=l,d[s]=l.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},g(y.prototype),y.prototype[o]=function(){return this},t.AsyncIterator=y,t.async=function(e,n,r,i){var o=new y(a(e,n,r,i));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},g(w),w[s]="Generator",w[i]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=k,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:k(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n.n(r),o=n(0),s=n.n(o),a=n(1),c=n.n(a),u={equal:0,delete:1,insert:2,none:3,replace:4},h=function(){function t(e,n,r){s()(this,t),this.startInOld=e,this.startInNew=n,this.size=r}return c()(t,[{key:"endInOld",get:function(){return this.startInOld+this.size}},{key:"endInNew",get:function(){return this.startInNew+this.size}}]),t}(),l=/^\s*<\/?[^>]+>\s*$/,d=/<[^\s>]+/,f=/^(\s|&nbsp;)+$/,p=/[\w#@]+/,v=["<img"];function w(t){return!v.some((function(e){return null!==t&&0===t.indexOf(e)}))&&l.test(t)}function g(t,e,n){return"<".concat(e,' class="').concat(n,'">').concat(t,"</").concat(e,">")}function y(t){return"<"===t}function m(t){return"&"===t}function x(t){return";"===t}function I(t){return f.test(t)}function b(t){return w(t)?function(t){return t=d.exec(t)[0]+(-1!==t.indexOf("/>",t.length-2)?"/>":">")}(t):t}function k(t){return p.test(t)}function W(t,e,n){return t.push(e),t.length>n&&t.shift(),t.length!==n?null:t.join("")}var O=function(){function t(e,n,r,i,o,a,c){s()(this,t),this.oldWords=e,this.newWords=n,this.startInOld=r,this.endInOld=i,this.startInNew=o,this.endInNew=a,this.options=c}return c()(t,[{key:"indexNewWords",value:function(){this.wordIndices=new Map;for(var t=[],e=this.startInNew;e<this.endInNew;e++){var n=W(t,this.normalizeForIndex(this.newWords[e]),this.options.blockSize);null!==n&&(this.wordIndices.has(n)?this.wordIndices.get(n).push(e):this.wordIndices.set(n,[e]))}}},{key:"normalizeForIndex",value:function(t){return t=b(t),this.options.IgnoreWhiteSpaceDifferences&&I(t)?" ":t}},{key:"findMatch",value:function(){var t=this;if(this.indexNewWords(),this.removeRepeatingWords(),0===this.wordIndices.length)return null;for(var e=this.startInOld,n=this.startInNew,r=0,i=new Map,o=this.options.blockSize,s=[],a=function(a){var c=t.normalizeForIndex(t.oldWords[a]),u=W(s,c,o);if(null===u)return"continue";var h=new Map;if(!t.wordIndices.has(u))return i=h,"continue";t.wordIndices.get(u).forEach((function(t){var s=(i.has(t-1)?i.get(t-1):0)+1;h.set(t,s),s>r&&(e=a-s-o+2,n=t-s-o+2,r=s)})),i=h},c=this.startInOld;c<this.endInOld;c++)a(c);return 0!==r?new h(e,n,r+o-1):null}},{key:"removeRepeatingWords",value:function(){var t=this,e=this.newWords.length+this.options.repeatingWordsAccuracy,n=[];this.wordIndices.forEach((function(t,r){t.length>e&&n.push(r)})),n.forEach((function(e){t.wordIndices.delete(e)}))}}]),t}(),N=function t(e,n,r,i,o){s()(this,t),this.action=e,this.startInOld=n,this.endInOld=r,this.startInNew=i,this.endInNew=o},E=function t(){s()(this,t),this.blockSize=0,this.repeatingWordsAccuracy=0,this.ignoreWhitespaceDifferences=!1},T={character:0,tag:1,whitespace:2,entity:3};function j(t,e){for(var n={mode:T.character,currentWord:[],words:[]},r=function(t,e){var n=new Map;if(null===e)return n;return e.forEach((function(e){for(var r;null!==(r=e.exec(t));){if(n.has(r.index))throw new Error("One or more block expressions result in a text sequence that overlaps. Current expression: "+e.toString());n.set(r.index,r.index+r[0].length)}})),n}(t,e),i=!!r.size,o=!1,s=-1,a=0;a<t.length;a++){var c=t[a];if(i){s===a&&(s=-1,o=!1);if(r.has(a)&&(o=!0,s=r.get(a)),o){n.currentWord.push(c),n.mode=T.character;continue}}switch(n.mode){case T.character:y(c)?L(n,"<",T.tag):m(c)?L(n,c,T.entity):I(c)?L(n,c,T.whitespace):k(c)&&(0===n.currentWord.length||k(n.currentWord[n.currentWord.length-1]))?n.currentWord.push(c):L(n,c,T.character);break;case T.tag:">"===c?(n.currentWord.push(c),n.words.push(n.currentWord.join("")),n.currentWord=[],n.mode=I(c)?T.whitespace:T.character):n.currentWord.push(c);break;case T.whitespace:y(c)?L(n,c,T.tag):m(c)?L(n,c,T.entity):I(c)?n.currentWord.push(c):L(n,c,T.character);break;case T.entity:if(y(c))L(n,c,T.tag);else if(I(c))L(n,c,T.whitespace);else if(x(c)){var u=!0;if(0!==n.currentWord.length&&(n.currentWord.push(c),n.words.push(n.currentWord.join("")),n.words.length>2&&I(n.words[n.words.length-2])&&I(n.words[n.words.length-1]))){var h=n.words[n.words.length-2],l=n.words[n.words.length-1];n.words.splice(n.words.length-2,2),n.currentWord=[(h+l).split()],n.mode=T.whitespace,u=!1}u&&(n.currentWord=[],n.mode=T.character)}else k(c)?n.currentWord.push(c):L(n,c,T.character)}}return 0!==n.currentWord.length&&n.words.push(n.currentWord.join("")),n.words}function L(t,e,n){0!==t.currentWord.length&&t.words.push(t.currentWord.join("")),t.currentWord=[e],t.mode=n}var S=new Map([["</strong>",0],["</em>",0],["</b>",0],["</i>",0],["</big>",0],["</small>",0],["</u>",0],["</sub>",0],["</strike>",0],["</s>",0],["</dfn>",0]]),M=/<((strong)|(b)|(i)|(dfn)|(em)|(big)|(small)|(u)|(sub)|(sup)|(strike)|(s))[>\s]+/gi,_=function(){function t(e,n){s()(this,t),this.content=[],this.newText=n,this.oldText=e,this.specialTagDiffStack=[],this.newWords=[],this.oldWords=[],this.matchGranularity=0,this.blockExpressions=[],this.repeatingWordsAccuracy=1,this.ignoreWhiteSpaceDifferences=!1,this.orphanMatchThreshold=0}return c()(t,[{key:"build",value:function(){var t=this;return this.oldText===this.newText?this.newText:void 0===this.oldText||null===this.oldText?this.newText:void 0===this.newText||null===this.newText?this.oldText:(this.splitInputsIntoWords(),this.matchGranularity=Math.min(4,this.oldWords.length,this.newWords.length),this.operations().forEach((function(e){t.performOperation(e)})),this.content.join(""))}},{key:"addBlockExpression",value:function(t){this.blockExpressions.push(t)}},{key:"splitInputsIntoWords",value:function(){this.oldWords=j(this.oldText,this.blockExpressions),this.oldText=null,this.newWords=j(this.newText,this.blockExpressions),this.newText=null}},{key:"performOperation",value:function(t){switch(t.action){case u.equal:this.processEqualOperation(t);break;case u.delete:this.processDeleteOperation(t,"diffdel");break;case u.insert:this.processInsertOperation(t,"diffins");break;case u.none:break;case u.replace:this.processReplaceOperation(t)}}},{key:"processReplaceOperation",value:function(t){this.processDeleteOperation(t,"diffmod"),this.processInsertOperation(t,"diffmod")}},{key:"processInsertOperation",value:function(t,e){var n=this.newWords.filter((function(e,n){return n>=t.startInNew&&n<t.endInNew}));this.insertTag("ins",e,n)}},{key:"processDeleteOperation",value:function(t,e){var n=this.oldWords.filter((function(e,n){return n>=t.startInOld&&n<t.endInOld}));this.insertTag("del",e,n)}},{key:"processEqualOperation",value:function(t){var e=this.newWords.filter((function(e,n){return n>=t.startInNew&&n<t.endInNew}));this.content.push(e.join(""))}},{key:"insertTag",value:function(t,e,n){for(;n.length;){var r=this.extractConsecutiveWords(n,(function(t){return!w(t)})),i="",o=!1;if(0!==r.length){var s=g(r.join(""),t,e);this.content.push(s)}else{if(M.test(n[0])){var a=n[0].match(M);if(a="<"+a[0].replace(/(<|>| )/g,"")+">",this.specialTagDiffStack.push(a),i='<ins class="mod">',"del"===t)for(n.shift();n.length>0&&M.test(n[0]);)n.shift()}else if(S.has(n[0])){var c=0===this.specialTagDiffStack.length?null:this.specialTagDiffStack.pop();if(null===c||c!==n[n.length-1].replace(/\//g,"")||(i="</ins>",o=!0),"del"===t)for(n.shift();n.length>0&&S.has(n[0]);)n.shift()}if(0===n.length&&0===i.length)break;o?this.content.push(i+this.extractConsecutiveWords(n,w).join("")):this.content.push(this.extractConsecutiveWords(n,w).join("")+i)}}}},{key:"extractConsecutiveWords",value:function(t,e){for(var n=null,r=0;r<t.length;r++){var i=t[r];if(0===r&&" "===i&&(t[r]="&nbsp;"),!e(i)){n=r;break}}if(null!==n){var o=t.filter((function(t,e){return e>=0&&e<n}));return n>0&&t.splice(0,n),o}var s=t.filter((function(e,n){return n>=0&&n<t.length}));return t.splice(0,t.length),s}},{key:"operations",value:function(){var t=0,e=0,n=[],r=this.matchingBlocks();r.push(new h(this.oldWords.length,this.newWords.length,0));for(var i,o,s=this.removeOrphans(r);!(i=s.next()).done;){var a=t===(o=i.value).startInOld,c=e===o.startInNew,l=void 0;(l=a||c?a&&!c?u.insert:a?u.none:u.delete:u.replace)!==u.none&&n.push(new N(l,t,o.startInOld,e,o.startInNew)),0!==o.length&&n.push(new N(u.equal,o.startInOld,o.endInOld,o.startInNew,o.endInNew)),t=o.endInOld,e=o.endInNew}return n}},{key:"removeOrphans",value:i.a.mark((function t(e){var n,r,o,s,a,c,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=null,r=null,o=0;case 3:if(!(o<e.length)){t.next=27;break}if(s=e[o],null!==r){t.next=9;break}return n=new h(0,0,0),r=s,t.abrupt("continue",24);case 9:if(!(n.endInOld===r.startInOld&&n.endInNew===r.startInNew||r.endInOld===s.startInOld&&r.endInNew===s.startInNew)){t.next=15;break}return t.next=12,r;case 12:return n=r,r=s,t.abrupt("continue",24);case 15:if(a=function(t,e){return t+e.length},c=this.oldWords.slice(n.endInOld,s.startInOld).reduce(a,0),u=this.newWords.slice(n.endInNew,s.startInNew).reduce(a,0),!(this.newWords.slice(r.startInNew,r.endInNew).reduce(a,0)>Math.max(c,u)*this.orphanMatchThreshold)){t.next=22;break}return t.next=22,r;case 22:n=r,r=s;case 24:o++,t.next=3;break;case 27:return t.next=29,r;case 29:case"end":return t.stop()}}),t,this)}))},{key:"matchingBlocks",value:function(){var t=[];return this.findMatchingBlocks(0,this.oldWords.length,0,this.newWords.length,t),t}},{key:"findMatchingBlocks",value:function(t,e,n,r,i){var o=this.findMatch(t,e,n,r);null!==o&&(t<o.startInOld&&n<o.startInNew&&this.findMatchingBlocks(t,o.startInOld,n,o.startInNew,i),i.push(o),o.endInOld<e&&o.endInNew<r&&this.findMatchingBlocks(o.endInOld,e,o.endInNew,r,i))}},{key:"findMatch",value:function(t,e,n,r){for(var i=this.matchGranularity;i>0;i--){var o=new E;o.blockSize=i,o.repeatingWordsAccuracy=this.repeatingWordsAccuracy,o.ignoreWhitespaceDifferences=this.ignoreWhiteSpaceDifferences;var s=new O(this.oldWords,this.newWords,t,e,n,r,o).findMatch();if(null!==s)return s}return null}}]),t}();_.execute=function(t,e){return new _(t,e).build()};e.default=_}]);